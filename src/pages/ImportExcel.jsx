import { useState } from 'react'; import { parseExcel } from '../lib/excel.js'; import { useToast } from '../components/Toasts.jsx'; export default function ImportExcel(){ const toast=useToast(); const [step,setStep]=useState(1); const [rows,setRows]=useState([]); async function onFile(e){ const file=e.target.files?.[0]; if(!file) return; try{ const json=await parseExcel(file); setRows(json); setStep(2) }catch(err){ toast.push({type:'error',message:'File non valido'}) } } return (<main className='mx-auto max-w-6xl px-4 py-8'><h2 className='text-2xl font-semibold'>Importa Excel</h2><p className='text-white/60 text-sm'>Wizard a 3 passi: File → Mapping → Anteprima</p>{step===1&&(<div className='mt-6 rounded-2xl bg-core-card p-6 shadow-e1'><input type='file' accept='.xlsx,.xls' onChange={onFile} className='text-sm'/></div>)}{step===2&&(<div className='mt-6 rounded-2xl bg-core-card p-6 shadow-e1'><div className='text-sm'>Mapping colonne (demo):</div><pre className='mt-2 text-xs bg-black/30 p-3 rounded'>{JSON.stringify(Object.keys(rows[0]||{}), null, 2)}</pre><button onClick={()=>setStep(3)} className='mt-4 rounded bg-core-violet px-3 py-2 text-sm'>Continua</button></div>)}{step===3&&(<div className='mt-6 rounded-2xl bg-core-card p-6 shadow-e1'><div className='text-sm'>Anteprima (prime 5 righe):</div><pre className='mt-2 text-xs bg-black/30 p-3 rounded'>{JSON.stringify(rows.slice(0,5), null, 2)}</pre><div className='mt-4 flex gap-2'><button onClick={()=>toast.push({type:'success',message:'Import completato'})} className='rounded bg-core-violet px-3 py-2 text-sm'>Importa</button><button onClick={()=>setStep(1)} className='rounded bg-white/10 px-3 py-2 text-sm hover:bg-white/15'>Ricomincia</button></div></div>)}</main>) }
